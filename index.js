(function(A,I,l,u,i,d,E,f,g,S,v){"use strict";const B=u.findByProps("ActionSheet")?.ActionSheet??u.find(function(e){return e.render?.name==="ActionSheet"}),{ActionSheetTitleHeader:x,ActionSheetCloseButton:N}=u.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton"),U=u.findByProps("openLazy","hideActionSheet"),{openLazy:R,hideActionSheet:C}=U;function y(e,t){try{R(new Promise(function(o){return o({default:e})}),"ActionSheet",t)}catch(o){I.logger.error(o.stack),S.showToast("Got error when opening ActionSheet! Please check debug logs")}}u.findByProps("showSimpleActionSheet");const T=function(e){let{title:t,onClose:o,children:c}=e;return React.createElement(B,null,React.createElement(x,{title:t,trailing:React.createElement(N,{onPress:o??function(){return C()}})}),React.createElement(i.ReactNative.View,null,c))};T.open=function(e,t){R(new Promise(function(o){return o({default:e})}),"ActionSheet",t)};const h={toInt(e){return e=e.replace(/^#/,""),parseInt(e,16)},toHex(e){return"#"+e.toString(16).toUpperCase()},HSLtoHEX(e,t,o){o/=100;const c=t*Math.min(o,1-o)/100,n=function(r){const s=(r+e/30)%12,a=o-c*Math.max(Math.min(s-3,9-s,1),-1);return Math.round(255*a).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`}},{FormRow:m}=g.Forms,{Text:k}=g.General,M=u.findByName("CustomColorPickerActionSheet"),b=i.stylesheet.createThemedStyleSheet({wompwomp:{flexDirection:"column",gap:8},destructiveIcon:{tintColor:d.semanticColors.TEXT_DANGER},destructiveText:{color:d.semanticColors.TEXT_DANGER,fontWeight:"bold"}});function H(e){let{entry:t,index:o,entries:c,setEntries:n}=e;return React.createElement(T,{title:"Message Actions"},React.createElement(m,{label:"Modify User ID",onPress:function(){E.showInputAlert({title:"Edit User ID",placeholder:"Enter new User ID",initialValue:t.userId,confirmText:"Save",onConfirm:function(r){const s=[...c];s[o]={...t,userId:r},l.storage.colors={entries:s},n(s),S.showToast("User ID updated!",f.getAssetIDByName("Check")),C()}})}}),React.createElement(m,{label:"Change Color",onPress:function(){y(M,{color:h.toInt(t.color),title:"Select Color",onSelect:function(r){const s=h.toHex(r),a=[...c];a[o]={...t,color:s},l.storage.colors={entries:a},n(a),S.showToast("Color updated!",f.getAssetIDByName("Check")),C()}})}}),React.createElement(m,{label:React.createElement(k,{style:b.destructiveText},"Delete Entry"),leading:React.createElement(m.Icon,{style:b.destructiveIcon,source:f.getAssetIDByName("ic_trash_24px")}),onPress:function(){const r=c.filter(function(s,a){return a!==o});l.storage.colors={entries:r},n(r),S.showToast("Entry deleted!",f.getAssetIDByName("Check")),C()}}))}const{FormRow:L}=g.Forms,{View:_,TouchableOpacity:G,Image:O}=g.General,w=u.findByName("CustomColorPickerActionSheet");function $(){const[e,t]=i.React.useState(l.storage.colors?.entries||[]),o=function(n,r){y(H,{entry:n,index:r,entries:e,setEntries:t})},c=function(){E.showInputAlert({title:"Enter User ID",confirmText:"Save",cancelText:"Cancel",placeholder:"Type here...",onConfirm:function(n){y(w,{color:h.toInt("#000000"),title:"Select Color",onSelect:function(r){const s=h.toHex(r),a=[...e,{userId:n,color:s}];l.storage.colors={entries:a},t(a),d.toasts.showToast("Color entry added!")}})}})};return i.React.createElement(i.React.Fragment,null,e.map(function(n,r){return i.React.createElement(L,{key:r,label:`User ID: ${n.userId}`,subLabel:"Tap to change color",onPress:function(){y(w,{color:h.toInt(n.color),title:"Select Color",onSelect:function(s){const a=h.toHex(s),p=[...e];p[r]={...n,color:a},l.storage.colors={entries:p},t(p),d.toasts.showToast("Color updated!")}})},onLongPress:function(){return o(n,r)},trailing:i.React.createElement(_,{style:{width:24,height:24,borderRadius:12,backgroundColor:n.color,borderWidth:1,borderColor:d.semanticColors.BACKGROUND_SECONDARY}})})}),i.React.createElement(G,{style:D.fab,onPress:c},i.React.createElement(O,{source:f.getAssetIDByName("ic_add_24px"),style:D.fabIcon})))}const D=i.stylesheet.createThemedStyleSheet({fab:{position:"absolute",bottom:20,right:20,backgroundColor:d.semanticColors.BACKGROUND_SECONDARY,borderRadius:50,width:56,height:56,justifyContent:"center",alignItems:"center",elevation:6},fabIcon:{width:24,height:24,tintColor:"white"}}),F=u.findByProps("MessageUsername")?.MessageUsername;let P;function z(){P=v.before("default",F,function(e){let[t]=e;const o=t?.message?.author?.id;if(!o)return;const c=l.storage.colors?.entries?.find(function(n){return n.userId===o});c&&(t.style||(t.style={}),t.style.color=c.color)})}var V={onLoad:function(){l.storage.colors=l.storage.colors??{entries:[]},z(),I.logger.log("Username Colors plugin loaded!")},onUnload:function(){P?.(),I.logger.log("Username Colors plugin unloaded.")},settings:$};return A.default=V,Object.defineProperty(A,"__esModule",{value:!0}),A})({},vendetta,vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.ui,vendetta.ui.alerts,vendetta.ui.assets,vendetta.ui.components,vendetta.ui.toasts,vendetta.patcher);
