(function(A,f,i,d,l,u,E,g,C,y,v){"use strict";const B=d.findByProps("ActionSheet")?.ActionSheet??d.find(function(e){return e.render?.name==="ActionSheet"}),{ActionSheetTitleHeader:x,ActionSheetCloseButton:N}=d.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton"),U=d.findByProps("openLazy","hideActionSheet"),{openLazy:R,hideActionSheet:S}=U;function m(e,t){try{R(new Promise(function(o){return o({default:e})}),"ActionSheet",t)}catch(o){f.logger.error(o.stack),y.showToast("Got error when opening ActionSheet! Please check debug logs")}}d.findByProps("showSimpleActionSheet");const T=function(e){let{title:t,onClose:o,children:a}=e;return React.createElement(B,null,React.createElement(x,{title:t,trailing:React.createElement(N,{onPress:o??function(){return S()}})}),React.createElement(l.ReactNative.View,null,a))};T.open=function(e,t){R(new Promise(function(o){return o({default:e})}),"ActionSheet",t)};const h={toInt(e){return e=e.replace(/^#/,""),parseInt(e,16)},toHex(e){return"#"+e.toString(16).toUpperCase()},HSLtoHEX(e,t,o){o/=100;const a=t*Math.min(o,1-o)/100,n=function(r){const c=(r+e/30)%12,s=o-a*Math.max(Math.min(c-3,9-c,1),-1);return Math.round(255*s).toString(16).padStart(2,"0")};return`#${n(0)}${n(8)}${n(4)}`}},{FormRow:p}=C.Forms,{Text:k}=C.General,M=d.findByName("CustomColorPickerActionSheet"),b=l.stylesheet.createThemedStyleSheet({wompwomp:{flexDirection:"column",gap:8},destructiveIcon:{tintColor:u.semanticColors.TEXT_DANGER},destructiveText:{color:u.semanticColors.TEXT_DANGER,fontWeight:"bold"}});function H(e){let{entry:t,index:o,entries:a,setEntries:n}=e;return React.createElement(T,{title:"Message Actions"},React.createElement(p,{label:"Modify User ID",onPress:function(){E.showInputAlert({title:"Edit User ID",placeholder:"Enter new User ID",initialValue:t.userId,confirmText:"Save",onConfirm:function(r){const c=[...a];c[o]={...t,userId:r},i.storage.colors={entries:c},n(c),y.showToast("User ID updated!",g.getAssetIDByName("Check")),S()}})}}),React.createElement(p,{label:"Change Color",onPress:function(){m(M,{color:h.toInt(t.color),title:"Select Color",onSelect:function(r){const c=h.toHex(r),s=[...a];s[o]={...t,color:c},i.storage.colors={entries:s},n(s),y.showToast("Color updated!",g.getAssetIDByName("Check")),S()}})}}),React.createElement(p,{label:React.createElement(k,{style:b.destructiveText},"Delete Entry"),leading:React.createElement(p.Icon,{style:b.destructiveIcon,source:g.getAssetIDByName("ic_trash_24px")}),onPress:function(){const r=a.filter(function(c,s){return s!==o});i.storage.colors={entries:r},n(r),y.showToast("Entry deleted!",g.getAssetIDByName("Check")),S()}}))}const{FormRow:L}=C.Forms,{View:G,TouchableOpacity:$,Image:O}=C.General,w=d.findByName("CustomColorPickerActionSheet");function _(){const[e,t]=l.React.useState(i.storage.colors?.entries||[]),o=function(n,r){m(H,{entry:n,index:r,entries:e,setEntries:t})},a=function(){E.showInputAlert({title:"Enter User ID",confirmText:"Save",cancelText:"Cancel",placeholder:"Type here...",onConfirm:function(n){m(w,{color:h.toInt("#000000"),title:"Select Color",onSelect:function(r){const c=h.toHex(r),s=[...e,{userId:n,color:c}];i.storage.colors={entries:s},t(s),u.toasts.showToast("Color entry added!")}})}})};return l.React.createElement(l.React.Fragment,null,e.map(function(n,r){return l.React.createElement(L,{key:r,label:`User ID: ${n.userId}`,subLabel:"Tap to change color",onPress:function(){m(w,{color:h.toInt(n.color),title:"Select Color",onSelect:function(c){const s=h.toHex(c),I=[...e];I[r]={...n,color:s},i.storage.colors={entries:I},t(I),u.toasts.showToast("Color updated!")}})},onLongPress:function(){return o(n,r)},trailing:l.React.createElement(G,{style:{width:24,height:24,borderRadius:12,backgroundColor:n.color,borderWidth:1,borderColor:u.semanticColors.BACKGROUND_SECONDARY}})})}),l.React.createElement($,{style:D.fab,onPress:a},l.React.createElement(O,{source:g.getAssetIDByName("ic_add_24px"),style:D.fabIcon})))}const D=l.stylesheet.createThemedStyleSheet({fab:{position:"absolute",bottom:20,right:20,backgroundColor:u.semanticColors.BACKGROUND_SECONDARY,borderRadius:50,width:56,height:56,justifyContent:"center",alignItems:"center",elevation:6},fabIcon:{width:24,height:24,tintColor:"white"}}),F=d.findByName("MessagesItemChannelContent");let P;function z(){P=v.before("default",F,function(e){let[t]=e;f.logger.log("MessagesItemChannelContent props:",t),t.children&&(Array.isArray(t.children)?t.children:[t.children]).forEach(function(o,a){f.logger.log(`Child ${a} type:`,o?.type?.name||o?.type)})})}var V={onLoad:function(){i.storage.colors=i.storage.colors??{entries:[]},z(),f.logger.log("Username Colors plugin loaded!")},onUnload:function(){P?.(),f.logger.log("Username Colors plugin unloaded.")},settings:_};return A.default=V,Object.defineProperty(A,"__esModule",{value:!0}),A})({},vendetta,vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.ui,vendetta.ui.alerts,vendetta.ui.assets,vendetta.ui.components,vendetta.ui.toasts,vendetta.patcher);
